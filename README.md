Вычисление интегралов от фундаментального решения уравнения Лапласа и его градиента 
===================================================================================

![Треугольные панели](https://media.arxiv-vanity.com/render-output/6021340/x16.png "Треугольные панели на поверхностной сетке")

![Repo Size](https://img.shields.io/github/repo-size/vortexmethods/integrator.svg)


Программный модуль реализует алгоритмы вычислния однократных и повторных интегралов от фундаментального решения уравнения Лапласа и его градиента по панелям (в двумерных задачах - прямым, в трехмерных задачах - треугольным). Подобные интегралы возникают при решении граничных интегральных уравнений при кусочно-постоянном представлении решения на панелях

Реализация основана на [статье](https://num-meth.ru/index.php/journal/article/view/1203)

*Марчевский И.К., Серафимова С.Р.* Аналитическое и полуаналитическое вычисление интегралов от логарифмического и ньютоновского потенциала и их градиентов по прямолинейным отрезкам и треугольным панелям // *Вычислительные методы и программирование*. 2022. Т. 23, № 2. С. 137-152. doi: [10.26089/NumMet.v23r209](https://doi.org/10.26089/NumMet.v23r209)


Программа зарегистрирована в ФИПС 

[Свидетельство о Государственной регистрации № 2022660947 от 10 июня 2022 г.](https://new.fips.ru/registers-doc-view/fips_servlet?DB=EVM&DocNumber=2022660947&TypeFile=html)

Copyright (C) 2022 Гумирова А.И., Марчевский И.К., Серафимова С.Р.

СОДЕРЖАНИЕ РЕПОЗИТОРИЯ
----------------------

* В папке **src** - исходный код

* В папке **example** - примеры сеток

### Документация
* Документация разработчика доступна по [ссылке](https://vortexmethods.github.io/integrator)

      https://vortexmethods.github.io/integrator

НЕОБХОДИМОЕ ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ
-----------------------------------

Для компиляции **integrator** требуется наличие установленных: 

* системы автоматизации сборки программного обеспечения из исходного кода [cmake](https://cmake.org/),
* компилятора с языка C++, поддерживающего технологию *OpenMP* и стандарт *С++17*,
* библиотеки *MPI*, например, [Open MPI](https://www.open-mpi.org/) или [Microsoft MPI](https://docs.microsoft.com/en-us/message-passing-interface/microsoft-mpi),

ЗАГРУЗКА ИСХОДНЫХ КОДОВ
-----------------------

Для установки программы **integrator** на комьютере необходимо загрузить исходные коды программы.

Если на Вашем компьютере установлен *Git*, достаточно исполнить команду 

      git clone https://github.com/vortexmethods/integrator.git

по результатам работы которой в текущей папке будет создана подпапка *integrator* и в нее будут загружены все файлы из репозитория, включая исходные коды, примеры решаемых задач, скрипты и т.п.
	  
Если *Git* на Вашем компьютере не установлен, исходные коды могут быть загружены непосредственно с [GitHub-странице проекта *integrator*](https://github.com/vortexmethods/integrator)


ПОДГОТОВКА К УСТАНОВКЕ
----------------------
  
Подготовка к компияции исходных кодов предполагает создание папки *build* в каталоге с загруженными исходными кодами, переход в эту папку и выполнение команды 

      cmake ..
	  
При необходимости следует указать необходимые ключи для настройки используемых компиляторов, указания опций компиляции и т.п., возможно, потребуется также некоторая модификация файла *CMakeLists.txt*, содержащего параметры настройки *CMake* и располагающегося в корневом каталоге.

В частности, для подготовки исходных кодов для их последующей компиляции в *Windows* средствами *MS Visual Studio* при использовании Visual Studio 2017 следует использовать следующую команду 

      cmake -G"Visual Studio 15 2017 Win64" ..
	  
(опция *Win64* обязательна, при использовании *Visual Studio 2019* или более новых она включена по умолчанию для 64-битных систем)
	  
	  
В случае использования в *Windows* компилятора, отличного от используемого по умолчанию (как правило, встроенного в *MS Visual Studio* компилятора *MSVC*), например, компилятора *Intel*, при подготовке исходных кодов к компиляции необходимо указать, в зависимости от версии, соответствующий ключ, например,
	  
      -T"Intel C++ Compiler 19.2"
	  
	  -T"Intel C++ Compiler 2021"
	  
	  -T"Intel(R) oneAPI DPC++ Compiler"
	  
В *Linux*, если требуется использовать вместо компилятора *gcc/g++* какой-либо другой, к примеру, компилятор *Intel* (*icpc*), следует исполнить команду

	  CXX=icpc camke ..
  

КОМПИЛЯЦИЯ ИСХОДНЫХ КОДОВ
-------------------------	  
	  
Процедура компиляции зависит от используемой операционной системы. 

В *Windows*, как правило, при помощи *CMake* создается проект для его поледующего открытия и компиляции средствами *MS Visual Studio* (см. выше). 

В *Linux* достаточно исполнения из созданной папки команды

      make

Если компиляция (в *Linux*) завершается ошибкой, связанной с отсутствием необходимых библиотек *MPI*, можно попробовать очистить папку *build*, перейти в нее и вместо команды *cmake ..* исполнить одну из следующих команд

      CXX=mpiCC cmake ..
	  
	  CXX=mpiicpc cmake ..
	  	  
и после ее успешного выполнения повторить компиляцию при помощи команды *make*.	  

ОБНОВЛЕНИЯ
----------

* 01.03.2022 - исходная версия-прототип
* 04.03.2022 - добавлена функция расчета интегралов I3DM
* 11.03.2022 - добавлена возможность работы по MPI
* 02.04.2022 - добавлена возможность выполнять интегрирование по гауссовым точкам, сделаны I2DM, I3DM, J2DM, J3DM (без частных случаев)
* 22.05.2022 - добавлено рассмотрение частных случаев
* 02.08.2022 - добавлена возможность обеспечения заданной точности путем доразбивки панелей по правилу Рунге

### Требует доработки
* Устранить гонку данных при сборке статистики доразбиений
* Устранить ошибку передачи данных по MPI в режиме Split